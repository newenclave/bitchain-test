


<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Blog">
    <head>
        





<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Network interoperability (pt. 1)</title>

<meta name="author" content="Davide De Rosa" />
<meta name="description" content="Often, the average bitcoiner is not aware that multiple blockchains exist. Most people transparently connect to the main network, because wallet software by default operates in the realm of real money. In fact, you’re going to discover 3 different Bitcoin...">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="apple-mobile-web-app-title" content="keeshux">
<meta name="google-site-verification" content="-Pof3b1_qR1iiTunLBZdJwz97Wh63qhs134ZIKNAwyY" />

<!-- Twitter -->


<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@keeshux" />
<meta name="twitter:title" content="Network interoperability (pt. 1)" />
<meta name="twitter:url" content="http://davidederosa.com/basic-blockchain-programming/network-interoperability-part-one/" />
<meta name="twitter:image" content="http://davidederosa.com/s/f/bitcoin/bitcoin.png?1468962375" />


<meta name="twitter:description" content="Often, the average bitcoiner is not aware that multiple blockchains exist. Most people transparently connect to the main network, because wallet software by default operates in the realm of real money. In fact, you’re going to discover 3 different Bitcoin..." />

<!-- Facebook -->

<meta property="og:url" content="http://davidederosa.com/basic-blockchain-programming/network-interoperability-part-one/" />
<meta property="og:title" content="Network interoperability (pt. 1)" />
<meta property="og:description" content="Often, the average bitcoiner is not aware that multiple blockchains exist. Most people transparently connect to the main network, because wallet software by default operates in the realm of real money. In fact, you’re going to discover 3 different Bitcoin..." />
<meta property="og:image" content="http://davidederosa.com/s/f/bitcoin/bitcoin.png?1468962375" />

<!-- Google+ -->

<meta itemprop="name" content="Network interoperability (pt. 1)" />
<meta itemprop="description" content="Often, the average bitcoiner is not aware that multiple blockchains exist. Most people transparently connect to the main network, because wallet software by default operates in the realm of real money. In fact, you’re going to discover 3 different Bitcoin..." />
<meta itemprop="image" content="http://davidederosa.com/s/f/bitcoin/bitcoin.png?1468962375" />

<link rel="canonical" href="index.html" />
<link rel="author" href="https://plus.google.com/+keeshux" />
<link rel="alternate" href="../../feed.xml" type="application/atom+xml" title="Davide De Rosa" />
<link rel="sitemap" href="../../sitemap.xml" type="application/xml" title="Sitemap" />

<link rel="prev" href="../network-interoperability-part-two/index.html" title="Network interoperability (pt. 2)" />


<link rel="next" href="../elliptic-curve-digital-signatures/index.html" title="Elliptic-curve digital signatures" />


<link rel="stylesheet" href="../../s/main.css@1468962375.css" />
<link rel="stylesheet" href="../../s/main-mobile.css@1468962375.css" media="handheld, only screen and (max-device-width: 600px)" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Raleway:600,400" />
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" />

<link rel="shortcut icon" href="../../s/favicon.ico@1468962375" />
<link rel="apple-touch-icon" href="../../s/iphone-icon-precomposed.png@1468962375" />

    </head>
    <body>
        <div id="container">
            <header>
                <nav id="menu">
    <ul>
        
            
            
            <li>
                
                <a class="active" href="../../index.html">stories</a>
                
            </li>
        
            
            
            <li>
                
                <a href="../../work/index.html">work</a>
                
            </li>
        
            
            
            <li>
                
                <a href="../../about/index.html">about</a>
                
            </li>
        
    </ul>
</nav>

            </header>
            <div>
                <header>
                    <h1><a href="../../index.html">Davide De Rosa</a></h1>
                </header>
                <main>
                    <article class="post post-full" itemscope itemtype="http://schema.org/Article">
    <header>
        
<div class="post-icon">
    <a href="index.html">
        
        <img src="../../s/f/bitcoin/bitcoin-150.png" alt="Network interoperability (pt. 1)" />
        
    </a>
</div>


        <div>
            <span class="post-date" itemprop="datepublished">May 14, 2015</span>
            <h2 itemprop="name">
                
                <a href="https://github.com/keeshux/basic-blockchain-programming" title="Network interoperability (pt. 1)">Network interoperability (pt. 1)</a>
                
            </h2>
            <div class="post-list post-categories">
    in
    
    <a href="../../category/basic-blockchain-programming.html">basic blockchain programming</a>
    
</div>

            






<div class="post-list post-series-links">
    part of a <a href="../../basic-blockchain-programming.1.html" title="A developer-oriented series about Bitcoin">series</a>:
    
    <a href="../elliptic-curve-digital-signatures/index.html" title="Elliptic-curve digital signatures">&lt; prev</a>
    
    |
    
    <a href="../network-interoperability-part-two/index.html" title="Network interoperability (pt. 2)">next &gt;</a>
    
</div>



        </div>
    </header>
    <div class="post-body">
        
<p class="post-see"><a href="https://github.com/keeshux/basic-blockchain-programming" title="Network interoperability (pt. 1)">
    
    <i class="fa fa-github"></i> See on Github
    
</a></p>


        
<aside class="sharing sharing-buttons">
    <div class="addthis_sharing_toolbox"></div>
</aside>

        

        <p>Often, the average bitcoiner is not aware that multiple blockchains exist. Most people transparently connect to the main network, because wallet software by default operates in the realm of real money. In fact, you’re going to discover 3 different Bitcoin networks with their own peculiarities.</p>

<!--more-->

<h3 id="parallel-universes">Parallel universes</h3>

<p>As an user, I expect you to know that Bitcoin is backed by a vast peer-to-peer network. To be more precise, there are 2 public subnetworks:</p>

<ul>
  <li><em>Mainnet</em></li>
  <li><em>Testnet3</em></li>
</ul>

<p>with the “3” suffix meaning the 3rd generation of Testnet. Under normal operation wallet clients connect to Mainnet, the only network where bitcoins have concrete value in real life. Testnet name is self-explanatory, it’s the best choice for testing and software development since Testnet coins are worthless.</p>

<p>The third network is sort a virtual network and is called <em>Regtest</em>. The name stands for “regression test” and it’s a specific mode of Bitcoin Core in which local blocks are mined immediately. Regtest is therefore substantially different from Mainnet and Testnet3, where miners must comply with a certain set of consensus rules. Quick blocks make Regtest particularly interesting: it makes possible creating custom blockchains with negligible processing power.</p>

<h4 id="identifying-networks">Identifying networks</h4>

<p>Mainnet and Testnet3 mainly differ in the default TCP port for p2p access and the prefix of transmitted packets (little-endian):</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>port</th>
      <th>packet prefix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Mainnet</td>
      <td>8333</td>
      <td><code class="highlighter-rouge">f9 be b4 d9</code></td>
    </tr>
    <tr>
      <td>Testnet3</td>
      <td>18333</td>
      <td><code class="highlighter-rouge">0b 11 09 07</code></td>
    </tr>
  </tbody>
</table>

<p>Additionally, Testnet3 validation rules are much more relaxed thus making room for experimental transactions.</p>

<p>Let alone the genesis block, blockchains are completely network agnostic. That is, blocks and transactions embed no information about the network they live in. There’s no way to tell the network that broadcast a transaction from the transaction data alone. Incidentally, a transaction can be published as-is to both Mainnet and Testnet3.</p>

<p>To avoid ambiguity, user shared entities (namely private keys and <em>addresses</em>) were made network-dependent by adding magic prefixes. Later we’ll learn what these prefixes are and how they affect the way keys and addresses are displayed.</p>

<h3 id="the-base58-encoding">The Base58 encoding</h3>

<p>There are entities that even the average Bitcoin user is bound to deal with: keys and addresses. In an attempt to make them shorter and slightly more human-readable than hexes, Bitcoin introduces the <em>Base58</em> encoding. Base58 is a stripped down version of <a href="http://en.wikipedia.org/wiki/Base64">Base64</a>, a widely known scheme to display binary data in ASCII text. Here’s how Base58 differs:</p>

<ul>
  <li>Base58 only has alphanumeric symbols, no <code class="highlighter-rouge">+</code> and <code class="highlighter-rouge">/</code>.</li>
  <li>Base58 excludes <code class="highlighter-rouge">0</code>, <code class="highlighter-rouge">O</code>, <code class="highlighter-rouge">I</code>, <code class="highlighter-rouge">l</code> for visual ambiguity.</li>
  <li>Base58 strings are fully selectable with a double-click.</li>
  <li>Base58 symbol values follow the ASCII ordering.</li>
</ul>

<p>The complete Base58 alphabet:</p>

<table>
  <thead>
    <tr>
      <th>Value</th>
      <th>Ch</th>
      <th>Value</th>
      <th>Ch</th>
      <th>Value</th>
      <th>Ch</th>
      <th>Value</th>
      <th>Ch</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>15</td>
      <td>G</td>
      <td>30</td>
      <td>X</td>
      <td>45</td>
      <td>n</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>16</td>
      <td>H</td>
      <td>31</td>
      <td>Y</td>
      <td>46</td>
      <td>o</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>17</td>
      <td>J</td>
      <td>32</td>
      <td>Z</td>
      <td>47</td>
      <td>p</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>18</td>
      <td>K</td>
      <td>33</td>
      <td>a</td>
      <td>48</td>
      <td>q</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>19</td>
      <td>L</td>
      <td>34</td>
      <td>b</td>
      <td>49</td>
      <td>r</td>
    </tr>
    <tr>
      <td>5</td>
      <td>6</td>
      <td>20</td>
      <td>M</td>
      <td>35</td>
      <td>c</td>
      <td>50</td>
      <td>s</td>
    </tr>
    <tr>
      <td>6</td>
      <td>7</td>
      <td>21</td>
      <td>N</td>
      <td>36</td>
      <td>d</td>
      <td>51</td>
      <td>t</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>22</td>
      <td>P</td>
      <td>37</td>
      <td>e</td>
      <td>52</td>
      <td>u</td>
    </tr>
    <tr>
      <td>8</td>
      <td>9</td>
      <td>23</td>
      <td>Q</td>
      <td>38</td>
      <td>f</td>
      <td>53</td>
      <td>v</td>
    </tr>
    <tr>
      <td>9</td>
      <td>A</td>
      <td>24</td>
      <td>R</td>
      <td>39</td>
      <td>g</td>
      <td>54</td>
      <td>w</td>
    </tr>
    <tr>
      <td>10</td>
      <td>B</td>
      <td>25</td>
      <td>S</td>
      <td>40</td>
      <td>h</td>
      <td>55</td>
      <td>x</td>
    </tr>
    <tr>
      <td>11</td>
      <td>C</td>
      <td>26</td>
      <td>T</td>
      <td>41</td>
      <td>i</td>
      <td>56</td>
      <td>y</td>
    </tr>
    <tr>
      <td>12</td>
      <td>D</td>
      <td>27</td>
      <td>U</td>
      <td>42</td>
      <td>j</td>
      <td>57</td>
      <td>z</td>
    </tr>
    <tr>
      <td>13</td>
      <td>E</td>
      <td>28</td>
      <td>V</td>
      <td>43</td>
      <td>k</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>14</td>
      <td>F</td>
      <td>29</td>
      <td>W</td>
      <td>44</td>
      <td>m</td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>With such a mapping, the Base58 encoding is just a number base conversion. The only tricky part comes from big numbers, as seen in <a href="https://github.com/keeshux/basic-blockchain-programming/blob/master/base58.h">base58.h</a>. Beware of endianness, contrary to the majority of blockchain objects Base58 strings are encoded big-endian.</p>

<h4 id="base58check">Base58Check</h4>

<p>Since Base58 strings are long and unfriendly, a checksum suffix is typically appended to avoid typos. The checksum consists of the first 4 bytes of hash256(payload). The (payload + checksum) format is called <em>Base58Check</em>. Steps:</p>

<ol>
  <li>Perform hash256 on the payload bytes.</li>
  <li>The first 4 bytes of the hash256 digest are the checksum.</li>
  <li>Append the checksum to the payload.</li>
  <li>Encode the result to Base58.</li>
</ol>

<p>Base58Check examples will be treated in the second part.</p>

<h3 id="get-the-code">Get the code!</h3>

<p>Updated shared code: <a href="../../s/f/basic-blockchain-programming/bbp-common.tar.gz">bbp-common.tar.gz</a><br />
Examples: <a href="../../s/f/basic-blockchain-programming/bbp-ex-interop.tar.gz">bbp-ex-interop.tar.gz</a></p>

<p>Full source on <a href="https://github.com/keeshux/basic-blockchain-programming/">GitHub</a>.</p>

<h3 id="next-block-in-chain">Next block in chain?</h3>

<p>You learned that there are 3 different Bitcoin networks. Real money flows on Mainnet, while test money resides on Testnet3. Regtest is for testing local, custom blockchains. All the long strings shared for bitcoin transfers are encoded Base58.</p>

<p>In the <a href="../network-interoperability-part-two/index.html">next article</a> I’ll complete the big picture with keys serialization and <em>addresses</em>, the typical transaction endpoints. Please share this post if you enjoyed it and use the form below for questions and comments!</p>


        
        
<aside class="sharing sharing-buttons">
    <div class="addthis_sharing_toolbox"></div>
</aside>

    </div>
    <aside class="sharing" id="sharing-me">
    <ul>
        <li><a href="../../feed.xml" title="Subscribe for updates"><i class="fa fa-rss"></i>Subscribe</a></li>
        <li><a href="https://twitter.com/keeshux" title="Follow me on Twitter"><i class="fa fa-twitter"></i>Follow</a></li>
    </ul>
</aside>

    
<aside class="post-list post-tags">
    <i class="fa fa-tags"></i>
    
    <a href="../../tag/bitcoin.html">bitcoin</a>, 
    
    <a href="../../tag/blockchain.html">blockchain</a>, 
    
    <a href="../../tag/programming.html">programming</a>, 
    
    <a href="../../tag/development.html">development</a>, 
    
    <a href="../../tag/base58.html">base58</a>, 
    
    <a href="../../tag/base58check.html">base58check</a>, 
    
    <a href="../../tag/networking.html">networking</a>
    
</aside>


    <aside class="post-related">
        <p>See also:</p>
        <ul>
            
            <li><a href="../the-first-transaction-part-two/index.html">The first transaction (pt. 2)</a></li>
            
            <li><a href="../the-first-transaction-part-one/index.html">The first transaction (pt. 1)</a></li>
            
            <li><a href="../inside-transactions/index.html">Inside transactions</a></li>
            
        </ul>
    </aside>
    <div id="disqus_thread"></div>
    <nav class="paginator">
    <ul>
        <li class="paginator-browser newer">
            
            <a href="../network-interoperability-part-two/index.html" title="Network interoperability (pt. 2)"><i class="fa fa-chevron-left"></i> Newer</a>
            
        </li><li class="paginator-browser home">
            <a href="../../index.html" class="fa fa-home"></a>
        </li><li class="paginator-browser older">
            
            <a href="../elliptic-curve-digital-signatures/index.html" title="Elliptic-curve digital signatures">Older <i class="fa fa-chevron-right"></i></a>
            
        </li>
    </ul>
</nav>

</article>

                </main>
                <footer id="page-footer">
                    <ul id="social">
    <li><a href="https://twitter.com/keeshux" title="Follow me on Twitter!" class="fa fa-twitter"></a></li>
    <li><a href="https://github.com/keeshux" title="Browse my GitHub repository" class="fa fa-github"></a></li>
    <li><a href="https://www.linkedin.com/in/davidederosa" title="See my LinkedIn profile" class="fa fa-linkedin-square"></a></li>
    <li><a href="mailto:website@davidederosa.com" title="Send me an email" class="fa fa-edit"></a></li>
    <li><a href="../../s/keeshux-gpg.txt" title="My GnuPG public key" class="fa fa-lock"></a></li>
</ul>
<p>
    <a href="bitcoin:16w2AWamiH2SS68NYSMDcrbh5MnZ1c5eju" title="Donate in Bitcoin" rel="nofollow">Donate bitcoins</a> to support my work.<br />
    <a href="bitcoin:16w2AWamiH2SS68NYSMDcrbh5MnZ1c5eju" title="Donate in Bitcoin" rel="nofollow" alt="Bitcoin address"><img id="bitcoin-qr" src="../../s/keeshux-bitcoin.svg" /></a>
</p>
<p>&copy; <a href="../../index.html">Davide De Rosa</a>. All rights reserved. <a title="Subscribe to my RSS feed" class="fa fa-rss-square" href="../../feed.xml"></a></p>

                </footer>
            </div>
        </div>
        <script type="text/javascript" src="../../s/main.js@1468962375" async="async"></script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-545ff75205bf1590" async="async"></script>
        <script type="text/javascript">
            var addthis_share = {
                'templates': {
                    'twitter': '“Basic blockchain programming”, {{title}} {{url}} #Bitcoin #blockchain via @keeshux'
                }
            };
        </script>
        
        <script type="text/javascript" src="http://keeshux.disqus.com/embed.js" async="async"></script>
        
    </body>
</html>
